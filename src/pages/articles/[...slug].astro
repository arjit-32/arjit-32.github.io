---
import { getCollection } from 'astro:content'
import BaseLayout from '@/layouts/BaseLayout.astro'
import { siteConfig } from '@/site-config'

export async function getStaticPaths() {
	const articles = await getCollection('articles')
	return articles.map((entry) => ({
		params: { slug: entry.slug },
		props: { entry },
	}))
}

const { entry } = Astro.props
const { Content } = await entry.render()
---

<BaseLayout title={entry.data.title} description={entry.data.description} articleDate={entry.data.publishDate}>
	<div class="mb-8 border-b border-border/40 pb-8">
		<a href="/articles/" class="text-sm text-muted-foreground hover:text-primary transition-colors mb-4 inline-block">&larr; Back to articles</a>
		<h1 class="text-3xl font-bold tracking-tight mb-2">{entry.data.title}</h1>
		<div class="flex items-center gap-4 text-sm text-muted-foreground">
			<time datetime={entry.data.publishDate.toISOString()}>
				{entry.data.publishDate.toLocaleDateString(siteConfig.date.locale, {
					year: "numeric",
					month: "long",
					day: "numeric"
				})}
			</time>
			<span>&bull;</span>
			<div class="flex gap-2">
				{entry.data.tags.map(tag => (
					<span>#{tag}</span>
				))}
			</div>
		</div>
	</div>

	<article class="prose dark:prose-invert prose-stone max-w-none">
		<Content />
	</article>
</BaseLayout>
